{"ast":null,"code":"var _jsxFileName = \"/home/mah-nigga/React/ChatApp/client/src/context/auth/AuthState.js\";\nimport React, { useReducer } from 'react';\nimport AuthContext from './AuthContext';\nimport AuthReducer from './AuthReducer';\nimport axios from 'axios';\nimport setAuthToken from '../../utils/setAuthToken';\nimport { LOGIN, REGISTER } from '../types';\n\nconst AuthState = props => {\n  const initialState = {\n    user: null,\n    isAuth: false\n  };\n  const [state, dispatch] = useReducer(AuthReducer, initialState);\n\n  const login = async formData => {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    const res = await axios.post('http://localhost:5000/auth/login', formData, config);\n    console.log(res.data);\n    getUser();\n    dispatch({\n      type: LOGIN,\n      payload: res.data\n    });\n  };\n\n  const register = async formData => {\n    console.log('state', formData);\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    const res = await axios.post('http://localhost:5000/auth/register', formData, config);\n    console.log(res.data);\n    dispatch({\n      type: REGISTER,\n      payload: formData\n    });\n  };\n\n  const getUser = async () => {\n    setAuthToken(localStorage.token);\n    const res = await axios.get('http://localhost:5000/auth/getUser');\n    console.log('[get-user]', res.data.user);\n\n    if (res.data) {\n      dispatch({\n        type: 'SET_USER',\n        payload: res.data.user\n      });\n    } else {\n      dispatch({\n        type: 'ERROR_USER'\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(AuthContext.Provider, {\n    value: {\n      isAuth: state.isAuth,\n      user: state.user,\n      login,\n      register,\n      getUser\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 5\n    }\n  }, props.children);\n};\n\nexport default AuthState;","map":{"version":3,"sources":["/home/mah-nigga/React/ChatApp/client/src/context/auth/AuthState.js"],"names":["React","useReducer","AuthContext","AuthReducer","axios","setAuthToken","LOGIN","REGISTER","AuthState","props","initialState","user","isAuth","state","dispatch","login","formData","config","headers","res","post","console","log","data","getUser","type","payload","register","localStorage","token","get","children"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,UAAhB,QAAkC,OAAlC;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,WAAP,MAAwB,eAAxB;AAEA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAOC,YAAP,MAAyB,0BAAzB;AAEA,SACEC,KADF,EAEEC,QAFF,QAGO,UAHP;;AAKA,MAAMC,SAAS,GAAGC,KAAK,IAAI;AACzB,QAAMC,YAAY,GAAG;AACnBC,IAAAA,IAAI,EAAE,IADa;AAEnBC,IAAAA,MAAM,EAAE;AAFW,GAArB;AAKA,QAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBb,UAAU,CAACE,WAAD,EAAcO,YAAd,CAApC;;AAEA,QAAMK,KAAK,GAAG,MAAMC,QAAN,IAAkB;AAC9B,UAAMC,MAAM,GAAG;AACbC,MAAAA,OAAO,EAAE;AACP,wBAAgB;AADT;AADI,KAAf;AAKA,UAAMC,GAAG,GAAG,MAAMf,KAAK,CAACgB,IAAN,CAAW,kCAAX,EAA+CJ,QAA/C,EAAyDC,MAAzD,CAAlB;AACAI,IAAAA,OAAO,CAACC,GAAR,CAAYH,GAAG,CAACI,IAAhB;AACAC,IAAAA,OAAO;AACPV,IAAAA,QAAQ,CAAC;AACPW,MAAAA,IAAI,EAAEnB,KADC;AAEPoB,MAAAA,OAAO,EAAEP,GAAG,CAACI;AAFN,KAAD,CAAR;AAID,GAbD;;AAeA,QAAMI,QAAQ,GAAG,MAAMX,QAAN,IAAkB;AACjCK,IAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBN,QAArB;AACA,UAAMC,MAAM,GAAG;AACbC,MAAAA,OAAO,EAAE;AACP,wBAAgB;AADT;AADI,KAAf;AAKA,UAAMC,GAAG,GAAG,MAAMf,KAAK,CAACgB,IAAN,CAAW,qCAAX,EAAkDJ,QAAlD,EAA4DC,MAA5D,CAAlB;AACAI,IAAAA,OAAO,CAACC,GAAR,CAAYH,GAAG,CAACI,IAAhB;AACAT,IAAAA,QAAQ,CAAC;AACPW,MAAAA,IAAI,EAAElB,QADC;AAEPmB,MAAAA,OAAO,EAAEV;AAFF,KAAD,CAAR;AAID,GAbD;;AAeA,QAAMQ,OAAO,GAAG,YAAY;AAC1BnB,IAAAA,YAAY,CAACuB,YAAY,CAACC,KAAd,CAAZ;AACA,UAAMV,GAAG,GAAG,MAAMf,KAAK,CAAC0B,GAAN,CAAU,oCAAV,CAAlB;AACAT,IAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BH,GAAG,CAACI,IAAJ,CAASZ,IAAnC;;AACA,QAAIQ,GAAG,CAACI,IAAR,EAAc;AACZT,MAAAA,QAAQ,CAAC;AACPW,QAAAA,IAAI,EAAE,UADC;AAEPC,QAAAA,OAAO,EAAEP,GAAG,CAACI,IAAJ,CAASZ;AAFX,OAAD,CAAR;AAID,KALD,MAKO;AACLG,MAAAA,QAAQ,CAAC;AACPW,QAAAA,IAAI,EAAE;AADC,OAAD,CAAR;AAGD;AACF,GAdD;;AAgBA,sBACE,oBAAC,WAAD,CAAa,QAAb;AACE,IAAA,KAAK,EAAE;AACLb,MAAAA,MAAM,EAAEC,KAAK,CAACD,MADT;AAELD,MAAAA,IAAI,EAAEE,KAAK,CAACF,IAFP;AAGLI,MAAAA,KAHK;AAILY,MAAAA,QAJK;AAKLH,MAAAA;AALK,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KASIf,KAAK,CAACsB,QATV,CADF;AAaD,CAnED;;AAqEA,eAAevB,SAAf","sourcesContent":["import React, { useReducer } from 'react'\nimport AuthContext from './AuthContext'\nimport AuthReducer from './AuthReducer'\n\nimport axios from 'axios'\n\nimport setAuthToken from '../../utils/setAuthToken'\n\nimport {\n  LOGIN,\n  REGISTER\n} from '../types'\n\nconst AuthState = props => {\n  const initialState = {\n    user: null,\n    isAuth: false\n  }\n\n  const [state, dispatch] = useReducer(AuthReducer, initialState)\n\n  const login = async formData => {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }\n    const res = await axios.post('http://localhost:5000/auth/login', formData, config)\n    console.log(res.data)\n    getUser()\n    dispatch({\n      type: LOGIN,\n      payload: res.data\n    })\n  }\n\n  const register = async formData => {\n    console.log('state', formData)\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      }\n    }\n    const res = await axios.post('http://localhost:5000/auth/register', formData, config)\n    console.log(res.data)\n    dispatch({\n      type: REGISTER,\n      payload: formData\n    })\n  }\n\n  const getUser = async () => {\n    setAuthToken(localStorage.token)\n    const res = await axios.get('http://localhost:5000/auth/getUser')\n    console.log('[get-user]', res.data.user)\n    if (res.data) {\n      dispatch({\n        type: 'SET_USER',\n        payload: res.data.user\n      })\n    } else {\n      dispatch({\n        type: 'ERROR_USER'\n      })\n    }\n  }\n\n  return (\n    <AuthContext.Provider\n      value={{\n        isAuth: state.isAuth,\n        user: state.user,\n        login,\n        register,\n        getUser\n      }}\n    >\n      { props.children }\n    </AuthContext.Provider>\n  )\n}\n\nexport default AuthState\n"]},"metadata":{},"sourceType":"module"}