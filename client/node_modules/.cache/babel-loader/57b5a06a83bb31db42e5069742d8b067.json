{"ast":null,"code":"import _slicedToArray from\"/home/mah-nigga/React/ChatApp/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState,useEffect,useRef}from'react';import M from'materialize-css/dist/js/materialize.min.js';import StreamContext from'../../context/streams/StreamContext';import AuthContext from'../../context/auth/AuthContext';var ChatBox=function ChatBox(props){var messages=props.messages;var streamContext=useContext(StreamContext);var sendMessage=streamContext.sendMessage,current=streamContext.current,updateStream=streamContext.updateStream,currentMessage=streamContext.currentMessage,resetCurrent=streamContext.resetCurrent;var authContext=useContext(AuthContext);var user=authContext.user,getUser=authContext.getUser;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),msg=_useState2[0],setMsg=_useState2[1];var msgRef=useRef();var onSend=function onSend(e){var obj={formData:{stream_id:current._id,text:msg,category:'text'},current:current};sendMessage(obj);setMsg('');};var handleInput=function handleInput(e){setMsg(e.target.value);};var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var titleChange=function titleChange(e){setTitle(e.target.value);};useEffect(function(){console.log(current);if(!current){var cs=JSON.parse(localStorage.getItem('current'));console.log('cs',cs);resetCurrent(cs);}else{setTitle(current.title);console.log(title);var _cs=JSON.stringify(current);localStorage.setItem('current',_cs);}getUser();},[]);var onSubmit=function onSubmit(e){console.log(title);var formData={id:997,title:title};updateStream(formData);};var openVideoChat=function openVideoChat(e){var obj={formData:{stream_id:current._id,text:'Video chat started',category:'video'},current:current};sendMessage(obj);setMsg('');};var copyLink=function copyLink(e){navigator.clipboard.writeText(current._id);M.toast({html:'Link copied'});};var joinVideoChat=function joinVideoChat(e){window.open(\"https://media.monerdaktar.com/\".concat(current._id));};if(!current){return/*#__PURE__*/React.createElement(\"p\",null,\"Select a stream\");}return/*#__PURE__*/React.createElement(\"div\",{className:\"chatbox\"},/*#__PURE__*/React.createElement(\"div\",{className:\"above-messages\"},/*#__PURE__*/React.createElement(\"div\",{className:\"left\"},/*#__PURE__*/React.createElement(\"div\",{className:\"image\"},/*#__PURE__*/React.createElement(\"img\",{src:\"https://robohash.org/\".concat(current._id,\"?set=set4\")})),/*#__PURE__*/React.createElement(\"div\",{className:\"title\"},/*#__PURE__*/React.createElement(\"a\",{className:\"modal-trigger\",href:\"#update-stream\"},/*#__PURE__*/React.createElement(\"h5\",null,title)))),/*#__PURE__*/React.createElement(\"div\",{className:\"right\",style:{display:'flex'}},/*#__PURE__*/React.createElement(\"i\",{className:\"small material-icons\",style:{cursor:'pointer',color:'gray'},onClick:openVideoChat},\"switch_video\"),/*#__PURE__*/React.createElement(\"i\",{className:\"small material-icons\",style:{cursor:'pointer',color:'gray'},onClick:copyLink},\"add_circle_outline\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"messages\",id:\"messages\",ref:msgRef},currentMessage.map(function(message){return message.sender_id==user._id?message.category==='text'?/*#__PURE__*/React.createElement(\"p\",{className:\"Green\"},/*#__PURE__*/React.createElement(\"span\",{className:\"bubble\"},message.text)):/*#__PURE__*/React.createElement(\"p\",{className:\"Green\"},/*#__PURE__*/React.createElement(\"span\",{className:\"bubble\"},/*#__PURE__*/React.createElement(\"button\",{onClick:joinVideoChat},\"Join\"))):message.category==='text'?/*#__PURE__*/React.createElement(\"p\",{className:\"Gray\"},/*#__PURE__*/React.createElement(\"span\",{className:\"bubble\"},message.text)):/*#__PURE__*/React.createElement(\"p\",{className:\"Gray\"},/*#__PURE__*/React.createElement(\"span\",{className:\"bubble\"},/*#__PURE__*/React.createElement(\"button\",{onClick:joinVideoChat},\"Join\")));})),/*#__PURE__*/React.createElement(\"div\",{className:\"type-area\"},/*#__PURE__*/React.createElement(\"textarea\",{name:\"msg\",value:msg,onChange:handleInput}),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"i\",{class:\"material-icons right\",onClick:onSend},\"send\"))));};export default ChatBox;","map":{"version":3,"sources":["/home/mah-nigga/React/ChatApp/client/src/components/pages/Chatbox.js"],"names":["React","useContext","useState","useEffect","useRef","M","StreamContext","AuthContext","ChatBox","props","messages","streamContext","sendMessage","current","updateStream","currentMessage","resetCurrent","authContext","user","getUser","msg","setMsg","msgRef","onSend","e","obj","formData","stream_id","_id","text","category","handleInput","target","value","title","setTitle","titleChange","console","log","cs","JSON","parse","localStorage","getItem","stringify","setItem","onSubmit","id","openVideoChat","copyLink","navigator","clipboard","writeText","toast","html","joinVideoChat","window","open","display","cursor","color","map","message","sender_id"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect, useRef } from 'react'\nimport M from 'materialize-css/dist/js/materialize.min.js'\n\nimport StreamContext from '../../context/streams/StreamContext'\nimport AuthContext from '../../context/auth/AuthContext'\n\nconst ChatBox = (props) => {\n  const { messages } = props\n\n  const streamContext = useContext(StreamContext)\n  const { sendMessage, current, updateStream, currentMessage, resetCurrent } = streamContext\n  const authContext = useContext(AuthContext)\n  const { user, getUser } = authContext\n\n  const [msg, setMsg] = useState('')\n  const msgRef = useRef()\n\n  const onSend = (e) => {\n    const obj = {\n      formData: {\n        stream_id: current._id,\n        text: msg,\n        category: 'text'\n      },\n      current\n    } \n    sendMessage(obj)\n    setMsg('')\n  }\n\n  const handleInput = (e) => {\n    setMsg(e.target.value)\n  }\n\n  const [title, setTitle] = useState('')\n  const titleChange = e => {\n    setTitle(e.target.value)\n  }\n\n  useEffect(() => {\n    console.log(current)\n    if (!current) {\n      const cs = JSON.parse(localStorage.getItem('current'))\n      console.log('cs', cs)\n      resetCurrent(cs)\n    } else {\n      setTitle(current.title)\n      console.log(title)\n      const cs = JSON.stringify(current)\n      localStorage.setItem('current', cs)\n    }\n    getUser()\n  }, [])\n\n  const onSubmit = e => {\n    console.log(title)\n    const formData = {\n      id: 997,\n      title\n    }\n    updateStream(formData)\n  }\n\n  const openVideoChat = e => {\n    const obj = {\n      formData: {\n        stream_id: current._id,\n        text: 'Video chat started',\n        category: 'video'\n      },\n      current\n    } \n    sendMessage(obj)\n    setMsg('')\n  }\n\n  const copyLink = e => {\n    navigator.clipboard.writeText( current._id )\n    M.toast({ html: 'Link copied' })\n  }\n\n  const joinVideoChat = e => {\n    window.open(`https://media.monerdaktar.com/${current._id}`)\n  }\n\n  if (!current) {\n    return (<p>Select a stream</p>)\n  }\n  return (\n    <div className='chatbox'>\n      <div className='above-messages'>\n        <div className='left'>\n          <div className='image'>\n            <img src={`https://robohash.org/${current._id}?set=set4`} />\n          </div>\n          <div className='title'>\n          <a className='modal-trigger' href='#update-stream'><h5>{title}</h5></a>  \n          </div>\n        </div>\n        <div className='right' style={{display: 'flex'}}>\n            <i className='small material-icons' style={{cursor: 'pointer', color: 'gray'}} onClick={openVideoChat}>switch_video</i>\n            <i className='small material-icons' style={{cursor: 'pointer', color: 'gray'}} onClick={copyLink}>add_circle_outline</i>\n        </div>\n      </div>\n      <div className='messages' id='messages' ref={msgRef}>\n        {\n          currentMessage.map(message => ( message.sender_id == user._id ? (message.category === 'text' ? (\n            <p className='Green'><span className='bubble'>{ message.text }</span></p>\n          ) : (\n            <p className='Green'><span className='bubble'><button onClick={joinVideoChat}>Join</button></span></p>\n          ) ) : \n        (message.category === 'text' ? (\n          <p className='Gray'><span className='bubble'>{ message.text }</span></p>\n        ) : (\n          <p className='Gray'><span className='bubble'><button onClick={joinVideoChat}>Join</button></span></p>\n        ) )))\n        }\n      </div>\n      <div className='type-area'>\n        <textarea name='msg' value={msg} onChange={handleInput}></textarea>\n        <p><i class=\"material-icons right\" onClick={onSend}>send</i></p>\n      </div>\n    </div>\n  )\n}\n\nexport default ChatBox\n"]},"metadata":{},"sourceType":"module"}