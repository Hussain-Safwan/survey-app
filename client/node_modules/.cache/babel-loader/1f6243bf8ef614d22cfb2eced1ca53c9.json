{"ast":null,"code":"import _regeneratorRuntime from\"/home/mah-nigga/React/ChatApp/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/mah-nigga/React/ChatApp/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/mah-nigga/React/ChatApp/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useReducer}from'react';import AuthContext from'./AuthContext';import AuthReducer from'./AuthReducer';import axios from'axios';import setAuthToken from'../../utils/setAuthToken';import{LOGIN,REGISTER}from'../types';var AuthState=function AuthState(props){var initialState={user:null,isAuth:false,loading:null};var _useReducer=useReducer(AuthReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var login=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(formData){var config,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};_context.next=3;return axios.post('http://localhost:5000/auth/login',formData,config);case 3:res=_context.sent;console.log(res.data);getUser();dispatch({type:LOGIN,payload:res.data});case 7:case\"end\":return _context.stop();}}},_callee);}));return function login(_x){return _ref.apply(this,arguments);};}();var register=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(formData){var config,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log('state',formData);config={headers:{\"Content-Type\":\"application/json\"}};_context2.next=4;return axios.post('http://localhost:5000/auth/register',formData,config);case 4:res=_context2.sent;console.log(res.data);dispatch({type:REGISTER,payload:formData});case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function register(_x2){return _ref2.apply(this,arguments);};}();var getUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setAuthToken(localStorage.token);console.log('getUser');_context3.next=4;return axios.get('http://localhost:5000/auth/getUser');case 4:res=_context3.sent;console.log('[get-user]',res.data);if(res.data){dispatch({type:'SET_USER',payload:res.data});}else{dispatch({type:'ERROR_USER'});}case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function getUser(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(AuthContext.Provider,{value:{isAuth:state.isAuth,user:state.user,login:login,register:register,getUser:getUser}},props.children);};export default AuthState;","map":{"version":3,"sources":["/home/mah-nigga/React/ChatApp/client/src/context/auth/AuthState.js"],"names":["React","useReducer","AuthContext","AuthReducer","axios","setAuthToken","LOGIN","REGISTER","AuthState","props","initialState","user","isAuth","loading","state","dispatch","login","formData","config","headers","post","res","console","log","data","getUser","type","payload","register","localStorage","token","get","children"],"mappings":"8cAAA,MAAOA,CAAAA,KAAP,EAAgBC,UAAhB,KAAkC,OAAlC,CACA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,CACA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,CAEA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAEA,MAAOC,CAAAA,YAAP,KAAyB,0BAAzB,CAEA,OACEC,KADF,CAEEC,QAFF,KAGO,UAHP,CAKA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAAAC,KAAK,CAAI,CACzB,GAAMC,CAAAA,YAAY,CAAG,CACnBC,IAAI,CAAE,IADa,CAEnBC,MAAM,CAAE,KAFW,CAGnBC,OAAO,CAAE,IAHU,CAArB,CADyB,gBAOCZ,UAAU,CAACE,WAAD,CAAcO,YAAd,CAPX,4CAOlBI,KAPkB,iBAOXC,QAPW,iBASzB,GAAMC,CAAAA,KAAK,0FAAG,iBAAMC,QAAN,iIACNC,MADM,CACG,CACbC,OAAO,CAAE,CACP,eAAgB,kBADT,CADI,CADH,uBAMMf,CAAAA,KAAK,CAACgB,IAAN,CAAW,kCAAX,CAA+CH,QAA/C,CAAyDC,MAAzD,CANN,QAMNG,GANM,eAOZC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,IAAhB,EACAC,OAAO,GACPV,QAAQ,CAAC,CACPW,IAAI,CAAEpB,KADC,CAEPqB,OAAO,CAAEN,GAAG,CAACG,IAFN,CAAD,CAAR,CATY,sDAAH,kBAALR,CAAAA,KAAK,4CAAX,CAeA,GAAMY,CAAAA,QAAQ,2FAAG,kBAAMX,QAAN,qIACfK,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBN,QAArB,EACMC,MAFS,CAEA,CACbC,OAAO,CAAE,CACP,eAAgB,kBADT,CADI,CAFA,wBAOGf,CAAAA,KAAK,CAACgB,IAAN,CAAW,qCAAX,CAAkDH,QAAlD,CAA4DC,MAA5D,CAPH,QAOTG,GAPS,gBAQfC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,IAAhB,EACAT,QAAQ,CAAC,CACPW,IAAI,CAAEnB,QADC,CAEPoB,OAAO,CAAEV,QAFF,CAAD,CAAR,CATe,wDAAH,kBAARW,CAAAA,QAAQ,8CAAd,CAeA,GAAMH,CAAAA,OAAO,2FAAG,gJACdpB,YAAY,CAACwB,YAAY,CAACC,KAAd,CAAZ,CACAR,OAAO,CAACC,GAAR,CAAY,SAAZ,EAFc,uBAGInB,CAAAA,KAAK,CAAC2B,GAAN,CAAU,oCAAV,CAHJ,QAGRV,GAHQ,gBAIdC,OAAO,CAACC,GAAR,CAAY,YAAZ,CAA0BF,GAAG,CAACG,IAA9B,EACA,GAAIH,GAAG,CAACG,IAAR,CAAc,CACZT,QAAQ,CAAC,CACPW,IAAI,CAAE,UADC,CAEPC,OAAO,CAAEN,GAAG,CAACG,IAFN,CAAD,CAAR,CAID,CALD,IAKO,CACLT,QAAQ,CAAC,CACPW,IAAI,CAAE,YADC,CAAD,CAAR,CAGD,CAda,wDAAH,kBAAPD,CAAAA,OAAO,2CAAb,CAiBA,mBACE,oBAAC,WAAD,CAAa,QAAb,EACE,KAAK,CAAE,CACLb,MAAM,CAAEE,KAAK,CAACF,MADT,CAELD,IAAI,CAAEG,KAAK,CAACH,IAFP,CAGLK,KAAK,CAALA,KAHK,CAILY,QAAQ,CAARA,QAJK,CAKLH,OAAO,CAAPA,OALK,CADT,EASIhB,KAAK,CAACuB,QATV,CADF,CAaD,CArED,CAuEA,cAAexB,CAAAA,SAAf","sourcesContent":["import React, { useReducer } from 'react'\nimport AuthContext from './AuthContext'\nimport AuthReducer from './AuthReducer'\n\nimport axios from 'axios'\n\nimport setAuthToken from '../../utils/setAuthToken'\n\nimport {\n  LOGIN,\n  REGISTER\n} from '../types'\n\nconst AuthState = props => {\n  const initialState = {\n    user: null,\n    isAuth: false,\n    loading: null\n  }\n\n  const [state, dispatch] = useReducer(AuthReducer, initialState)\n\n  const login = async formData => {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }\n    const res = await axios.post('http://localhost:5000/auth/login', formData, config)\n    console.log(res.data)\n    getUser()\n    dispatch({\n      type: LOGIN,\n      payload: res.data\n    })\n  }\n\n  const register = async formData => {\n    console.log('state', formData)\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      }\n    }\n    const res = await axios.post('http://localhost:5000/auth/register', formData, config)\n    console.log(res.data)\n    dispatch({\n      type: REGISTER,\n      payload: formData\n    })\n  }\n\n  const getUser = async () => {\n    setAuthToken(localStorage.token)\n    console.log('getUser')\n    const res = await axios.get('http://localhost:5000/auth/getUser')\n    console.log('[get-user]', res.data)\n    if (res.data) {\n      dispatch({\n        type: 'SET_USER',\n        payload: res.data\n      })\n    } else {\n      dispatch({\n        type: 'ERROR_USER'\n      })\n    }\n  }\n\n  return (\n    <AuthContext.Provider\n      value={{\n        isAuth: state.isAuth,\n        user: state.user,\n        login,\n        register,\n        getUser\n      }}\n    >\n      { props.children }\n    </AuthContext.Provider>\n  )\n}\n\nexport default AuthState\n"]},"metadata":{},"sourceType":"module"}