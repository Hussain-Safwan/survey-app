(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{122:function(e,t){},125:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(62),l=a.n(c),s=(a(70),a(33)),o=a(2),i=(a(71),a(72),a(14)),m=a.n(i),u=r.a.createContext(),d=function(){var e=Object(n.useContext)(u),t=e.isAuth,a=e.getUser;return Object(n.useState)((function(){a()}),[]),r.a.createElement("nav",null,r.a.createElement("div",{class:"nav-wrapper green"},r.a.createElement("div",{className:"container"},r.a.createElement("a",{href:"#login-modal",className:"modal-trigger brand-logo"},"NiggaByte"),t?r.a.createElement("ul",{id:"nav-mobile",class:"right hide-on-med-and-down"},r.a.createElement("li",null,r.a.createElement("a",{href:"#"},"Sign out"))):r.a.createElement("ul",{id:"nav-mobile",class:"right hide-on-med-and-down"},r.a.createElement("li",null,r.a.createElement("a",{href:"#login-modal",className:"modal-trigger"},"Login")),r.a.createElement("li",null,r.a.createElement("a",{href:"#register-modal",className:"modal-trigger"},"Register"))))))},p=function(){var e=Object(n.useContext)(u),t=e.user;return e.isAuth?r.a.createElement("div",{className:"top-card"},r.a.createElement("div",{className:"image"},r.a.createElement("img",{src:"https://robohash.org/".concat(t._id)})),r.a.createElement("div",{className:"texts"},r.a.createElement("div",{className:"name"},r.a.createElement("h5",null,t.name)),r.a.createElement("div",{className:"username"},t.email))):r.a.createElement("p",{style:{textAlign:"center",padding:"100px 0"}},r.a.createElement("h5",null,"Log in to continue.."))},E=Object(n.createContext)(),g=a(3),f=function(e){var t=e.stream,a=t._id,c=t.title,l=t.participents,s=Object(n.useContext)(E),i=s.selectStream,m=s.deleteStream,u=Object(o.f)();return r.a.createElement("div",null,r.a.createElement("li",{class:"collection-item avatar",onClick:function(t){i(e.stream),u.push("/chat")}},r.a.createElement("img",{src:"https://robohash.org/".concat(a,"?set=set4"),alt:"",class:"circle"}),r.a.createElement("span",{class:"title"},c),r.a.createElement("p",{style:{color:"gray"}},l.length," Homiez"),r.a.createElement("a",{href:"#!",class:"secondary-content",onClick:function(t){m(e.stream)}},r.a.createElement("i",{class:"material-icons"},"delete"))))},h={display:"flex",justifyContent:"space-between"},v={color:"gray",marginTop:"10px",cursor:"pointer"},b=function(e){var t=Object(n.useContext)(E),a=(t.createStream,t.getStream),c=t.streams,l=(t.loading,t.currentMessage,Object(n.useState)("")),s=Object(g.a)(l,2);s[0],s[1];Object(n.useEffect)((function(){a()}),[]);return r.a.createElement("div",null,r.a.createElement("ul",{class:"collection with-header"},r.a.createElement("li",{class:"collection-header"},r.a.createElement("div",{style:h},r.a.createElement("h5",null,"Streams")," ",r.a.createElement("a",{className:"modal-trigger",href:"#create-stream"},r.a.createElement("i",{className:"small material-icons",style:v},"add"))," ")),c?c.map((function(e){return r.a.createElement(f,{stream:e})})):r.a.createElement("p",null,"Loading...")))},O=a(5),j=a.n(O),y=a(11),S=a(24),w=a(1),x=function(e,t){switch(t.type){case"GET_STREAM":return Object(w.a)(Object(w.a)({},e),{},{streams:t.payload,current:t.payload[0],currentMessage:t.payload[0].messages.reverse(),loading:!1});case"CHOOSE_STREAM":return Object(w.a)(Object(w.a)({},e),{},{current:t.payload,currentMessage:t.payload.messages.reverse()});case"SEND_MESSAGE":var a=t.payload,n=a.formData,r=a.current;return Object(w.a)(Object(w.a)({},e),{},{current:r,currentMessage:[].concat(Object(S.a)(e.currentMessage),[n]).reverse()});case"RENDER_MESSAGES":return Object(w.a)(Object(w.a)({},e),{},{current:t.payload,currentMessage:t.payload.messages.reverse()});case"SET_CURRENT":return Object(w.a)(Object(w.a)({},e),{},{current:t.payload,currentMessage:t.payload.messages});case"CREAT_STREAM":return Object(w.a)(Object(w.a)({},e),{},{streams:[].concat(Object(S.a)(e.streams),[t.payload])});case"DELETE_STREAM":return Object(w.a)(Object(w.a)({},e),{},{streams:e.streams.filter((function(e){return e.id!==t.payload.id})),current:e.streams[0]});case"JOIN_STREAM":return Object(w.a)(Object(w.a)({},e),{},{streams:[].concat(Object(S.a)(e.streams),[t.payload])});default:return Object(w.a)({},e)}},C=a(9),N=a.n(C),_=function(e){e?N.a.defaults.headers.common["x-auth-token"]=e:delete N.a.defaults.headers.common["x-auth-token"]},R=a(64),k=a.n(R)()("http://localhost:5000"),T=function(e){var t=Object(n.useReducer)(x,{current:null,streams:[],currentMessage:null,loading:!0}),a=Object(g.a)(t,2),c=a[0],l=a[1],s=Object(n.useContext)(u).user;k.on("new message",(function(e){o(e)}));var o=function(e){l({type:"RENDER_MESSAGES",payload:e})},i=function(){var e=Object(y.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=5;break}return e.next=3,N.a.get("http://localhost:5000/streams/".concat(s._id));case 3:t=e.sent,l({type:"GET_STREAM",payload:t.data});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=Object(y.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),l({type:"SET_CURRENT",payload:t});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(y.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=9;break}return a={headers:{"Content-Type":"application/json"}},n=t.formData,t.current,n.sender_id=s._id,n.sender_name=s.name,console.log(n),e.next=8,N.a.post("http://localhost:5000/streams/send",n,a);case 8:l({type:"SEND_MESSAGE",payload:t});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(y.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={headers:{"Content-Type":"application/json"}},!s){e.next=7;break}return n={title:t.title,owner_id:s._id,owner_name:s.name},e.next=5,N.a.post("http://localhost:5000/streams/create",n,a);case 5:e.sent,l({type:"CREAT_STREAM",payload:n});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(y.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="http://localhost:5000/streams/join/".concat(t,"/").concat(s._id),e.next=3,N.a.get(a);case 3:n=e.sent,console.log(n.data.newStream),l({type:"JOIN_STREAM",payload:n.data.newStream});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(E.Provider,{value:{streams:c.streams,messages:c.messages,current:c.current,currentMessage:c.currentMessage,loading:c.loading,getStream:i,sendMessage:d,selectStream:function(e){l({type:"CHOOSE_STREAM",payload:e})},resetCurrent:m,createStream:p,deleteStream:function(e){l({type:"DELETE_STREAM",payload:e})},updateStream:function(e){l({type:"UPDATE_STREAM",payload:e})},joinStream:f}},e.children)},A=function(){var e=Object(n.useContext)(E);e.getStream,e.streams,e.loading,e.messages;return r.a.createElement("div",{className:"chat-area"},r.a.createElement("div",{className:"streamlist"},r.a.createElement(b,null)))},M=a(15),U=function(){var e=Object(n.useContext)(u),t=(e.user,e.isAuth,e.login),a=Object(n.useState)({email:"",password:""}),c=Object(g.a)(a,2),l=c[0],s=c[1],o=function(e){s(Object(w.a)(Object(w.a)({},l),{},Object(M.a)({},e.target.name,e.target.value)))};l.email,l.password;return r.a.createElement("div",null,r.a.createElement("div",{id:"login-modal",class:"modal"},r.a.createElement("div",{class:"modal-content"},r.a.createElement("h4",null,"Login"),r.a.createElement("p",null,r.a.createElement("input",{onChange:o,name:"email",placeholder:"Email or Username"})),r.a.createElement("p",null,r.a.createElement("input",{type:"password",onChange:o,name:"password",placeholder:"Password"}))),r.a.createElement("div",{class:"modal-footer"},r.a.createElement("a",{href:"#!",class:"modal-close waves-effect waves-green btn-flat",onClick:function(){console.log(l),t(l)}},"Sign in"))))},G=function(){var e=Object(n.useContext)(u).register,t=Object(n.useState)({email:"",password:"",name:""}),a=Object(g.a)(t,2),c=a[0],l=a[1],s=function(e){l(Object(w.a)(Object(w.a)({},c),{},Object(M.a)({},e.target.name,e.target.value)))};c.email,c.password;return r.a.createElement("div",null,r.a.createElement("div",{id:"register-modal",class:"modal"},r.a.createElement("div",{class:"modal-content"},r.a.createElement("h4",null,"Register"),r.a.createElement("p",null,r.a.createElement("input",{onChange:s,name:"name",placeholder:"Your name"})),r.a.createElement("p",null,r.a.createElement("input",{onChange:s,name:"email",placeholder:"Email or Username"})),r.a.createElement("p",null,r.a.createElement("input",{type:"password",onChange:s,name:"password",placeholder:"Password"}))),r.a.createElement("div",{class:"modal-footer"},r.a.createElement("a",{href:"#!",class:"modal-close waves-effect waves-green btn-flat",onClick:function(){console.log(c),e(c)}},"Sign up"))))},D=function(){return r.a.createElement("div",null,r.a.createElement("div",{id:"update-stream",class:"modal"},r.a.createElement("div",{class:"modal-content"},r.a.createElement("h4",null,"Update Stream"),r.a.createElement("p",null,r.a.createElement("input",{placeholder:"Update"}))),r.a.createElement("div",{class:"modal-footer"},r.a.createElement("a",{href:"#!",class:"modal-close waves-effect waves-green btn"},"Save"))))},I=function(){return r.a.createElement("div",null,r.a.createElement("div",{class:"progress"},r.a.createElement("div",{class:"indeterminate"})))},J=function(e){e.messages;var t=Object(n.useContext)(E),a=t.sendMessage,c=t.current,l=(t.updateStream,t.currentMessage),s=t.resetCurrent,o=Object(n.useContext)(u),i=o.user,d=o.getUser,p=Object(n.useState)(""),f=Object(g.a)(p,2),h=f[0],v=f[1],b=Object(n.useRef)(),O=Object(n.useState)(""),j=Object(g.a)(O,2),y=j[0],S=j[1];Object(n.useEffect)((function(){if(console.log(c),c){S(c.title),console.log(y);var e=JSON.stringify(c);localStorage.setItem("current",e)}else{var t=JSON.parse(localStorage.getItem("current"));console.log("cs",t),s(t)}d()}),[]);var w=function(e){window.open("https://media.monerdaktar.com/".concat(c._id))};return c?r.a.createElement("div",{className:"chatbox"},r.a.createElement("div",{className:"above-messages"},r.a.createElement("div",{className:"left"},r.a.createElement("div",{className:"image"},r.a.createElement("img",{src:"https://robohash.org/".concat(c._id,"?set=set4")})),r.a.createElement("div",{className:"title"},r.a.createElement("a",{className:"modal-trigger",href:"#update-stream"},r.a.createElement("h5",null,y)))),r.a.createElement("div",{className:"right",style:{display:"flex"}},r.a.createElement("i",{className:"small material-icons",style:{cursor:"pointer",color:"gray"},onClick:function(e){var t={formData:{stream_id:c._id,text:"Video chat started",category:"video"},current:c};a(t),v("")}},"switch_video"),r.a.createElement("i",{className:"small material-icons",style:{cursor:"pointer",color:"gray"},onClick:function(e){navigator.clipboard.writeText(c._id),m.a.toast({html:"Link copied"})}},"add_circle_outline"))),r.a.createElement("div",{className:"messages",id:"messages",ref:b},l.map((function(e){return e.sender_id==i._id?"text"===e.category?r.a.createElement("p",{className:"Green"},r.a.createElement("span",{className:"bubble"},e.text)):r.a.createElement("p",{className:"Green"},r.a.createElement("span",{className:"bubble"},r.a.createElement("button",{onClick:w},"Join"))):"text"===e.category?r.a.createElement("p",{className:"Gray"},r.a.createElement("span",{className:"bubble"},e.text)):r.a.createElement("p",{className:"Gray"},r.a.createElement("span",{className:"bubble"},r.a.createElement("button",{onClick:w},"Join")))}))),r.a.createElement("div",{className:"type-area"},r.a.createElement("textarea",{name:"msg",value:h,onChange:function(e){v(e.target.value)}}),r.a.createElement("p",null,r.a.createElement("i",{class:"material-icons right",onClick:function(e){var t={formData:{stream_id:c._id,text:h,category:"text"},current:c};a(t),v("")}},"send")))):r.a.createElement("p",null,"Select a stream")},L=function(e,t){switch(t.type){case"LOGIN":return localStorage.setItem("token",t.payload.token),console.log(t.payload.token),Object(w.a)(Object(w.a)({},e),{},{user:t.payload,isAuth:!0,loading:!0});case"SET_USER":return Object(w.a)(Object(w.a)({},e),{},{user:t.payload,isAuth:!0,loading:!1});case"ERROR_USER":return Object(w.a)(Object(w.a)({},e),{},{user:null,isAuth:!1});default:return Object(w.a)({},e)}},P=function(e){var t=Object(n.useReducer)(L,{user:null,isAuth:!1,loading:null}),a=Object(g.a)(t,2),c=a[0],l=a[1],s=function(){var e=Object(y.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{"Content-Type":"application/json"}},e.next=3,N.a.post("http://localhost:5000/auth/login",t,a);case 3:n=e.sent,console.log(n.data),i(),l({type:"LOGIN",payload:n.data});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=Object(y.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("state",t),a={headers:{"Content-Type":"application/json"}},e.next=4,N.a.post("http://localhost:5000/auth/register",t,a);case 4:n=e.sent,console.log(n.data),l({type:"REGISTER",payload:t});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=Object(y.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _(localStorage.token),console.log("getUser"),e.next=4,N.a.get("http://localhost:5000/auth/getUser");case 4:t=e.sent,console.log("[get-user]",t.data),t.data?l({type:"SET_USER",payload:t.data}):l({type:"ERROR_USER"});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(u.Provider,{value:{isAuth:c.isAuth,user:c.user,login:s,register:o,getUser:i}},e.children)},B=function(){var e=Object(n.useContext)(E),t=e.createStream,a=e.joinStream,c=Object(n.useState)(""),l=Object(g.a)(c,2),s=l[0],o=l[1],i=Object(n.useState)(""),m=Object(g.a)(i,2),u=m[0],d=m[1];return r.a.createElement("div",{id:"create-stream",className:"modal"},r.a.createElement("div",{class:"modal-content"},r.a.createElement("h4",null,"Create Stream"),r.a.createElement("p",null,r.a.createElement("input",{name:"title",value:s,onChange:function(e){o(e.target.value)},placeholder:"Title for the stream"})),r.a.createElement("h5",null,"Or join an existing one"),r.a.createElement("p",{style:{display:"flex"}},r.a.createElement("input",{name:"link",value:u,onChange:function(e){d(e.target.value)},placeholder:"Place the link here"})," ",r.a.createElement("button",{onClick:function(e){console.log(u),a(u)}},"Join")," ")),r.a.createElement("div",{class:"modal-footer"},r.a.createElement("a",{href:"#!",class:"modal-close waves-effect waves-green btn",onClick:function(e){console.log(s),t({title:s})}},"Create")))},H=function(){var e=r.a.useContext(u);return Object(n.useEffect)((function(){e.getUser()}),[]),r.a.createElement("div",{className:"container"},r.a.createElement(U,null),r.a.createElement(G,null),r.a.createElement(D,null),r.a.createElement(B,null),e.isAuth?r.a.createElement(r.a.Fragment,null,r.a.createElement(p,null),r.a.createElement(A,null)):r.a.createElement(I,null))},W=function(){return Object(n.useEffect)((function(){m.a.AutoInit()}),[]),r.a.createElement("div",{className:"App"},r.a.createElement(P,null,r.a.createElement(T,null,r.a.createElement(s.a,null,r.a.createElement(d,null),r.a.createElement(o.c,null,r.a.createElement(o.a,{exact:!0,path:"/",component:H}),r.a.createElement(o.a,{exact:!0,path:"/chat",component:J}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(W,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},65:function(e,t,a){e.exports=a(125)},70:function(e,t,a){},71:function(e,t,a){}},[[65,1,2]]]);
//# sourceMappingURL=main.e1a210dd.chunk.js.map